<style>
    .boxItem {
        width: 100%;
        height: 100%;
    }
    .layui-form-select dl {
        max-height: 200px;
    }
</style>

<div style="width: 100%; height: 100%;" class="d-flex flex-row" id="step-5">
    <!-- left -->
    <div class="boxItem layui-form layui-anim layui-anim-fadein" style="padding-right: 1%; max-height:100%; overflow-y: auto; overflow-x: hidden; white-space: nowrap;">
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
            <legend>是否创建任务</legend>
        </fieldset>
        <div class="layui-form-item" style="padding-left: 15px;padding-right: 15px;">
            <div class="layui-inline">
                <input type="checkbox" lay-filter="examRemind" name="" title="创建考试提醒">
            </div>
            <div class="layui-inline">
                <input type="checkbox" lay-filter="examCountDown" name="" title="创建考试倒计时">
            </div>
        </div>

        <fieldset class="layui-elem-field layui-field-title layui-anim layui-anim-up" style="margin-top: 30px;" v-show="isShow.examRemind">
            <legend>开考提醒</legend>
        </fieldset>
        <div v-show="isShow.examRemind" class="layui-form-item layui-anim layui-anim-up" style="padding-left: 15px;padding-right: 15px;">
            <div class="layui-inline">
                <div class="layui-inline">
                    <input type="checkbox" lay-filter="examRemindBegin" name="" title="开考提醒" checked>
                </div>
                <div class="layui-inline">
                    <div class="d-flex flex-column">
                        <div class="d-flex flex-row">
                            <input type="checkbox" lay-skin="primary" title="前15分钟" checked="" lay-filter="examRemindBegin-15">
                            <input type="checkbox" lay-skin="primary" title="前30分钟" lay-filter="examRemindBegin-30">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div v-show="isShow.examRemind" class="layui-form-item layui-anim layui-anim-up" style="padding-left: 15px;padding-right: 15px;">
            <div class="layui-inline">
                <div class="layui-inline">
                    <input type="checkbox" lay-filter="examRemindEnd" name="" title="毕考提醒" checked>
                </div>
                <div class="layui-inline">
                    <div class="d-flex flex-column">
                        <div class="d-flex flex-row">
                            <input type="checkbox" lay-skin="primary" title="前15分钟" checked="" lay-filter="examRemindEnd-15">
                            <input type="checkbox" lay-skin="primary" title="前30分钟" lay-filter="examRemindEnd-30">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <fieldset class="layui-elem-field layui-field-title layui-anim layui-anim-up" style="margin-top: 30px;" v-show="isShow.examCountDown">
            <legend>考试倒计时</legend>
        </fieldset>
        <div v-show="isShow.examCountDown" class="layui-form-item layui-anim layui-anim-up" style="padding-left: 15px;padding-right: 15px;">
            <div class="layui-inline">
                <div class="layui-input-inline">
                    <input type="radio" name="examCountDownFre" value="once" title="仅一次"  lay-filter="examCountDownFre">
                    <input type="radio" name="examCountDownFre" value="everyday" title="每天" checked="" lay-filter="examCountDownFre">
                </div>
                <div class="layui-inline">
                    <div>
                        <div class="layui-input-inline">
                            <input type="text" name="birthday" id="taskStartDate" placeholder="任务开启时间" autocomplete="off" class="layui-input">
                        </div>
                        <div class="layui-input-inline">
                            <input type="checkbox" lay-skin="primary" title="现在开始" lay-filter="taskStartDate-now">
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>

    <!-- right -->
    <div class="boxItem d-flex flex-column" style="background: rgba(255,248,220,0.9); padding: 1% 1% 1% 1%;">
        <div class="boxItem" style="background: rgba(64,224,208,0.9);">
            <div style="width: 100%; height: 70%;" class="d-flex flex-column">
                <div class="showWindow-item d-flex flex-row">
                    <div class="flex-fill text-center">
                        <p style="margin-top: 14px; padding: 0px;">xxx</p>
                    </div>
                    <div class="flex-fill text-center" style="vertical-align: center;">
                        <p style="margin-top: 14px; padding: 0px;">xxx</p>
                    </div>
                    <div class="flex-fill text-center">
                        <p style="margin-top: 14px; padding: 0px;">xxx</p>
                    </div>
                    <div class="flex-fill text-center">
                        <p style="margin-top: 14px; padding: 0px;">xxx</p>
                    </div>
                    <div class="flex-fill text-center">
                        <p style="margin-top: 14px; padding: 0px;">xxx</p>
                    </div>
                    <div class="flex-fill text-center">
                        <button type="button" class="btn btn-dark" style="margin-top: 8px;" @click="continueCreating(creatingExam.id, creatingExam.stepCount)">继续</button>
                    </div>
                </div>
            </div>
            <div class="d-flex bd-highlight" style="width: 100%; height: 30%; background: rgba(0,0,0,0.6)">
                <div class="p-2 flex-grow-1 bd-highlight d-flex flex-column">
                    <div class="d-flex align-items-center" style="width: 100%; flex: 1;">
                        <h1 class="display-1" style="color: whitesmoke; font-size: 40px;">创建中的考试</h1>
                    </div>
                    <div class="d-flex align-items-center" style="width: 100%; flex: 1;">
                        <input type="text" class="form-control" placeholder="可以搜索所有的考试历史" aria-label="exam-history">
                    </div>
                </div>
                <div class="p-2 bd-highlight d-flex align-items-center" style="width: 30%; padding-left: 9%; padding-right: 3%;">
                    <button type="button" class="btn btn-dark btn-lg" style="height: 90%; width: 100%; font-size: 32px;"><i class="bi bi-search" style="font-size: 40px;"></i>&nbsp;&nbsp;搜索</button>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    var stepVue = new Vue({
        el : "#step-5",
        data : {
            isShow : {
                examRemind : false,
                examCountDown : false,
            },
            examRemind : {
                begin : {
                    remind : false,
                    doTime : ["15"],
                },
                end : {
                    remind : false,
                    doTime : ["15"],
                }
            },
            examCountDown : {
                fre : "",
                doTime : "",
                doTimeNow : false
            }
        },
        methods : {
            saveData : function () {
                var examRemind = stepVue.examRemind;
                var examCountDown = stepVue.examCountDown;
                var createExamRemind = stepVue.isShow.examRemind;
                var createExamCountDown = stepVue.isShow.examCountDown;
                var examId = examRegistVue.examId;
                if (examId==""){
                    layer.msg("缺少exam对象", {icon : 5});
                    return false;
                }

                var dataParam = {
                    examId : examId,
                    createExamRemind : createExamRemind,
                    createExamCountDown : createExamCountDown,
                    examRemind : examRemind,
                    examCountDown : examCountDown,
                }

                debugger;

                var step = "thirdStep";
                var thrRes = examRegistVue.doSubmit(step, dataParam);
                if (!thrRes){
                    return false;
                }

                return true;
            },
            initDefaultCheckBoxValue : function (examRemindShow, examCountDownShow) {
                //var examRemindShow = stepVue.isShow.examRemind;
                //var examCountDownShow = stepVue.isShow.examCountDown;

                if (examRemindShow!=null){
                    if (examRemindShow){
                        stepVue.examRemind.begin.remind = true;
                        stepVue.examRemind.begin.doTime = ['15'];
                        stepVue.examRemind.end.remind = true;
                        stepVue.examRemind.end.doTime = ['15'];
                    }else{
                        stepVue.examRemind.begin.remind = false;
                        stepVue.examRemind.begin.doTime = [];
                        stepVue.examRemind.end.remind = false;
                        stepVue.examRemind.end.doTime = [];
                    }
                }
                if (examCountDownShow!=null){
                    if (examCountDownShow){
                        stepVue.examCountDown.fre = 'everyday';
                    }else{
                        stepVue.examCountDown.fre = '';
                    }
                }

            }
        },
        mounted : function () {

        }
    })

    layui.use(['form', 'layedit', 'laydate'], function () {
        var form = layui.form
            ,layer = layui.layer
            ,layedit = layui.layedit
            ,laydate = layui.laydate;

        form.on('checkbox(examRemind)', function (data) {
            stepVue.isShow.examRemind = stepVue.isShow.examRemind ? false : true;
            stepVue.initDefaultCheckBoxValue(stepVue.isShow.examRemind, null);
            //form.render()
        })
        form.on('checkbox(examCountDown)', function (data) {
            stepVue.isShow.examCountDown = stepVue.isShow.examCountDown ? false : true;
            stepVue.initDefaultCheckBoxValue(null, stepVue.isShow.examCountDown);
            //form.render()
        })
        form.on('checkbox(examRemindBegin)', function (data) {
            stepVue.examRemind.begin.remind = data.value;
        })
        form.on('checkbox(examRemindEnd)', function (data) {
            stepVue.examRemind.end.remind = data.value;
        })
        form.on('checkbox(examRemindBegin-15)', function (data) {
            if (data.value){
                stepVue.examRemind.begin.doTime.push("15");
            }else{
                for (var e in stepVue.examRemind.begin.doTime){
                    if (e=="15"){
                        stepVue.examRemind.begin.doTime.remove(e);
                        break;
                    }
                }
            }
        })
        form.on('checkbox(examRemindBegin-30)', function (data) {
            if (data.value){
                stepVue.examRemind.begin.doTime.push("30");
            }else{
                for (var e in stepVue.examRemind.begin.doTime){
                    if (e=="30"){
                        stepVue.examRemind.begin.doTime.remove(e);
                        break;
                    }
                }
            }
        })
        form.on('checkbox(examRemindEnd-15)', function (data) {
            if (data.value){
                stepVue.examRemind.end.doTime.push("15");
            }else{
                for (var e in stepVue.examRemind.end.doTime){
                    if (e=="15"){
                        stepVue.examRemind.end.doTime.remove(e);
                        break;
                    }
                }
            }
        })
        form.on('checkbox(examRemindEnd-30)', function (data) {
            if (data.value){
                stepVue.examRemind.end.doTime.push("30");
            }else{
                for (var e in stepVue.examRemind.end.doTime){
                    if (e=="30"){
                        stepVue.examRemind.end.doTime.remove(e);
                        break;
                    }
                }
            }
        })
        form.on('radio(examCountDownFre)', function (data) {
            var fre = data.value;
            stepVue.examCountDown.fre = fre;
        })
        laydate.render({
            elem : "#taskStartDate",
            trigger : "click",
            done : function (value, date, endDate) {
                stepVue.examCountDown.doTime = value;
            }
        })
        form.on('checkbox(taskStartDate-now)', function (data) {
            if (data.value){
                stepVue.examCountDown.doTimeNow = true;
                $("#taskStartDate").attr("disabled", "disabled");
            }else{
                stepVue.examCountDown.doTimeNow = false;
                $("#taskStartDate").removeAttr("disabled");
            }

        })

        form.render();

    })

</script>